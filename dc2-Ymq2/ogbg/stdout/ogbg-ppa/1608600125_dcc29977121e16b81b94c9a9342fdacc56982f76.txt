{'dataset_name': 'ogbg-ppa', 'checkpoint_dir': './checkpoint', 'resume_train': './checkpoint/dcc2997_1608562836_ogbg-ppa_1.tar', 'num_workers': 2, 'feature': 'full', 'hyperparams': {'batch_size': 32, 'epochs': 801, 'learning_rate': 0.0005, 'step_size': 20, 'decay_rate': 0.8}, 'architecture': {'layers': 4, 'hidden': 230, 'pooling': 'add', 'JK': 'cat', 'nonlinear_conv': 'STB4', 'dropout': 0.5, 'variants': {'BN': 'Y'}}, 'commit_id': 'dcc29977121e16b81b94c9a9342fdacc56982f76', 'time_stamp': '1608600125', 'directory': '../../../nlg_results/dc2-Ymq2/ogbg/board/'}
Loading model from ./checkpoint/dcc2997_1608562836_ogbg-ppa_1.tar... Model loaded.
Epoch 5 evaluating...
Train: 0.6315984654731458 Validation: 0.5222394678492239 Test: 0.5528735632183908 Train loss: 1.8471317362473172 lr: 0.0005
Epoch 6 training...
Evaluating...
Train: 0.6227365728900256 Validation: 0.4761640798226164 Test: 0.536896551724138 Train loss: 1.3129719324568485 Train cov: 2.3297321846590978e-05 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 7 training...
Evaluating...
Train: 0.7458567774936061 Validation: 0.5685587583148559 Test: 0.6117241379310345 Train loss: 1.4872441036709008 Train cov: 1.1509077985621707e-05 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 8 training...
Evaluating...
Train: 0.7665856777493606 Validation: 0.5864079822616408 Test: 0.6539367816091954 Train loss: 1.0047735355843206 Train cov: 1.1627080516369765e-05 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 9 training...
Evaluating...
Train: 0.7717647058823529 Validation: 0.5803769401330376 Test: 0.6394827586206897 Train loss: 0.8333139857993677 Train cov: 1.3108293098855688e-05 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 10 training...
Evaluating...
Train: 0.8143222506393862 Validation: 0.5963414634146341 Test: 0.657183908045977 Train loss: 0.7442958740953435 Train cov: 1.3638411066834269e-05 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 11 training...
Evaluating...
Train: 0.8261764705882353 Validation: 0.6150332594235033 Test: 0.6525862068965518 Train loss: 0.6915297405291257 Train cov: 8.351535378542558e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 12 training...
Evaluating...
Train: 0.8431329923273657 Validation: 0.6223281596452328 Test: 0.6754597701149425 Train loss: 0.624878154468529 Train cov: 9.208649296021343e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 13 training...
Evaluating...
Train: 0.8548976982097186 Validation: 0.6340576496674057 Test: 0.6744252873563218 Train loss: 0.6167864792061125 Train cov: 7.986526929033065e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 14 training...
Evaluating...
Train: 0.861304347826087 Validation: 0.6413747228381375 Test: 0.6812068965517242 Train loss: 0.5330721759618414 Train cov: 8.641240017141544e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 15 training...
Evaluating...
Train: 0.8908695652173914 Validation: 0.6615521064301552 Test: 0.6933045977011494 Train loss: 0.5181722169049975 Train cov: 8.035574168520583e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 16 training...
Evaluating...
Train: 0.8694501278772379 Validation: 0.6362084257206209 Test: 0.6820689655172414 Train loss: 0.4795188784824895 Train cov: 7.3943764449196e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 17 training...
Evaluating...
Train: 0.8861764705882353 Validation: 0.6576053215077605 Test: 0.7049712643678161 Train loss: 0.4454056583741244 Train cov: 7.440488826966941e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 18 training...
Evaluating...
Train: 0.9055754475703325 Validation: 0.6745454545454546 Test: 0.7198275862068966 Train loss: 0.4196153353494264 Train cov: 7.999750648751138e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 19 training...
Evaluating...
Train: 0.9013938618925831 Validation: 0.6631042128603104 Test: 0.7134770114942529 Train loss: 0.41399163248645426 Train cov: 8.878122410570167e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 20 training...
Evaluating...
Train: 0.919309462915601 Validation: 0.6703325942350332 Test: 0.713132183908046 Train loss: 0.3891831587446753 Train cov: 9.909776625756866e-06 lr: 0.0005
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 21 training...
Evaluating...
Train: 0.9307033248081842 Validation: 0.6928159645232816 Test: 0.7336206896551725 Train loss: 0.32282724911491834 Train cov: 1.0929929674978156e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 22 training...
Evaluating...
Train: 0.928235294117647 Validation: 0.689490022172949 Test: 0.7249137931034483 Train loss: 0.3061722397121011 Train cov: 1.129028478257654e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 23 training...
Evaluating...
Train: 0.921841432225064 Validation: 0.677139689578714 Test: 0.725028735632184 Train loss: 0.30501690828687256 Train cov: 1.0622322294549343e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 24 training...
Evaluating...
Train: 0.9385038363171355 Validation: 0.6981152993348115 Test: 0.7401436781609195 Train loss: 0.2851787066441898 Train cov: 1.1108667666682796e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 25 training...
Evaluating...
Train: 0.9379028132992328 Validation: 0.6874279379157427 Test: 0.7319540229885058 Train loss: 0.2911607361455416 Train cov: 1.1991564204833584e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 26 training...
Evaluating...
Train: 0.9389130434782609 Validation: 0.6905321507760532 Test: 0.7519252873563218 Train loss: 0.27524769067938715 Train cov: 1.0869024735972956e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 27 training...
Evaluating...
Train: 0.9394373401534527 Validation: 0.6879822616407982 Test: 0.740316091954023 Train loss: 0.2590876372146943 Train cov: 1.058583415454907e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 28 training...
Evaluating...
Train: 0.9424424552429668 Validation: 0.7056541019955654 Test: 0.7399137931034483 Train loss: 0.2761105733914849 Train cov: 8.627824297844843e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 29 training...
Evaluating...
Train: 0.9513554987212276 Validation: 0.7021507760532151 Test: 0.7533045977011494 Train loss: 0.2617166940581645 Train cov: 9.227191996039084e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 30 training...
Evaluating...
Train: 0.9354092071611253 Validation: 0.6774279379157427 Test: 0.7228448275862069 Train loss: 0.25019520414799207 Train cov: 1.0055272310546719e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 31 training...
Evaluating...
Train: 0.9505626598465473 Validation: 0.7181152993348116 Test: 0.7509482758620689 Train loss: 0.2549159275507659 Train cov: 1.0270121735425871e-05 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 32 training...
Evaluating...
Train: 0.9504603580562659 Validation: 0.6999113082039912 Test: 0.7435344827586207 Train loss: 0.2319257768501113 Train cov: 7.440012883905292e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 33 training...
Evaluating...
Train: 0.9467902813299233 Validation: 0.7079822616407982 Test: 0.7439367816091954 Train loss: 0.32112094799969587 Train cov: 7.820426114088994e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 34 training...
Evaluating...
Train: 0.9552685421994885 Validation: 0.717649667405765 Test: 0.7533620689655173 Train loss: 0.24854911453599424 Train cov: 7.748854856968085e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 35 training...
Evaluating...
Train: 0.931304347826087 Validation: 0.6888691796008869 Test: 0.7341666666666666 Train loss: 0.2874700971762364 Train cov: 7.312883717933708e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 36 training...
Evaluating...
Train: 0.9323273657289003 Validation: 0.682039911308204 Test: 0.7228735632183908 Train loss: 0.24257442858297346 Train cov: 6.6480574905572194e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 37 training...
Evaluating...
Train: 0.9537595907928389 Validation: 0.700820399113082 Test: 0.7522988505747127 Train loss: 0.23310267677822732 Train cov: 6.912234669381161e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 38 training...
Evaluating...
Train: 0.9615984654731458 Validation: 0.7105321507760533 Test: 0.7626436781609195 Train loss: 0.23416206710937776 Train cov: 6.034340142485833e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 39 training...
Evaluating...
Train: 0.9598976982097187 Validation: 0.7070066518847007 Test: 0.7554885057471264 Train loss: 0.2136246256098062 Train cov: 6.046575604479478e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 40 training...
Evaluating...
Train: 0.9557289002557545 Validation: 0.7082039911308204 Test: 0.7527586206896552 Train loss: 0.23080318472244074 Train cov: 7.744308236389604e-06 lr: 0.0004
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 41 training...
Evaluating...
Train: 0.9688746803069054 Validation: 0.7134146341463414 Test: 0.7598563218390805 Train loss: 0.18437123096443656 Train cov: 8.603718363496355e-06 lr: 0.00032
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 42 training...
Evaluating...
Train: 0.9696803069053709 Validation: 0.7237250554323725 Test: 0.7661781609195403 Train loss: 0.17216877698623093 Train cov: 9.34421312432321e-06 lr: 0.00032
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 43 training...
Evaluating...
Train: 0.9689386189258312 Validation: 0.7154545454545455 Test: 0.7533620689655173 Train loss: 0.17813521233527535 Train cov: 8.597452687779956e-06 lr: 0.00032
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 44 training...
Evaluating...
Train: 0.9604731457800512 Validation: 0.7041463414634146 Test: 0.736264367816092 Train loss: 0.16181343223473985 Train cov: 8.559721380906728e-06 lr: 0.00032
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 45 training...
Evaluating...
Train: 0.9721994884910486 Validation: 0.720709534368071 Test: 0.7667528735632184 Train loss: 0.16823899456490826 Train cov: 9.189228086640146e-06 lr: 0.00032
Saving model as dcc2997_1608600125_ogbg-ppa_1.tar... Model saved.
Epoch 46 training...
Evaluating...
Train: 0.9708184143222507 Validation: 0.7281818181818182 Test: 0.7633045977011494 Train loss: 0.1704185096579553 Train cov: 8.242707660187863e-06 lr: 0.00032
Saving model as dcc2997_1608600125_ogbg-ppa_0.tar... Model saved.
Epoch 47 training...
Traceback (most recent call last):
  File "./main.py", line 245, in <module>
    main()
  File "./main.py", line 185, in main
    train_loss, train_cov = train(model, device, train_loader, optimizer, multicls_criterion)
  File "./main.py", line 44, in train
    loss.backward()
  File "/opt/conda/lib/python3.6/site-packages/torch/tensor.py", line 198, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/opt/conda/lib/python3.6/site-packages/torch/autograd/__init__.py", line 100, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 762.00 MiB (GPU 0; 15.75 GiB total capacity; 10.15 GiB already allocated; 754.62 MiB free; 13.92 GiB reserved in total by PyTorch) (malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:289)
frame #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x46 (0x2b60909b0536 in /opt/conda/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1cf1e (0x2b6090770f1e in /opt/conda/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1df9e (0x2b6090771f9e in /opt/conda/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: THCStorage_resize + 0x96 (0x2b6054fa43d6 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #4: at::native::(anonymous namespace)::resize_cuda_(at::Tensor&, c10::ArrayRef<long>, c10::optional<c10::MemoryFormat>) + 0x9aa (0x2b60567c7e4a in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0x2887de3 (0x2b60567c8de3 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf0ffe2 (0x2b6054e50fe2 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x1041be6 (0x2b6054f82be6 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #8: <unknown function> + 0xf65018 (0x2b6054ea6018 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #9: <unknown function> + 0x10c2780 (0x2b6046267780 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: <unknown function> + 0x2c9b47e (0x2b6047e4047e in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: <unknown function> + 0x10c2780 (0x2b6046267780 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::Tensor c10::Dispatcher::callUnboxed<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::OperatorHandle const&, at::Tensor const&, at::Tensor const&) const + 0xb3 (0x2b60440eeda3 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #13: <unknown function> + 0x28ac327 (0x2b6047a51327 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: torch::autograd::generated::AddmmBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x134 (0x2b6047a8bff4 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x2d89705 (0x2b6047f2e705 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&) + 0x16f3 (0x2b6047f2ba03 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&, bool) + 0x3d2 (0x2b6047f2c7e2 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::autograd::Engine::thread_init(int) + 0x39 (0x2b6047f24e59 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: torch::autograd::python::PythonEngine::thread_init(int) + 0x38 (0x2b60443b25f8 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #20: <unknown function> + 0xbd66f (0x2b60437bc66f in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #21: <unknown function> + 0x76db (0x2b60415636db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #22: clone + 0x3f (0x2b604189c88f in /lib/x86_64-linux-gnu/libc.so.6)

