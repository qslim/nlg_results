{'dataset_name': 'ogbg-ppa', 'checkpoint_dir': './checkpoint', 'num_workers': 2, 'feature': 'full', 'hyperparams': {'batch_size': 32, 'epochs': 601, 'learning_rate': 0.0005, 'step_size': 20, 'decay_rate': 0.8}, 'architecture': {'layers': 4, 'hidden': 256, 'pooling': 'add', 'JK': 'cat', 'nonlinear_conv': 'EB4', 'dropout': 0.5, 'variants': {'BN': 'Y', 'fea_activation': 'ReLU'}}, 'commit_id': '7e9542b0240da82fdde9245560aa88b8587e9a98', 'time_stamp': '1603430026', 'directory': '../../../nlg_results/dc2-Ymq2/ogbg/board/'}
Epoch 1 training...
Evaluating...
Train: 0.21294117647058824 Validation: 0.17942350332594234 Test: 0.20787356321839082 Train loss: 18.628312491160955 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 2 training...
Evaluating...
Train: 0.34167519181585676 Validation: 0.2898669623059867 Test: 0.3203735632183908 Train loss: 7.420647541649408 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 3 training...
Evaluating...
Train: 0.41053708439897696 Validation: 0.3270953436807095 Test: 0.37474137931034485 Train loss: 4.305809359210993 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 4 training...
Evaluating...
Train: 0.4829667519181586 Validation: 0.3720842572062084 Test: 0.4363793103448276 Train loss: 2.856892736009802 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 5 training...
Evaluating...
Train: 0.49625319693094627 Validation: 0.40095343680709533 Test: 0.4387068965517241 Train loss: 2.177021169379573 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 6 training...
Evaluating...
Train: 0.17506393861892583 Validation: 0.14645232815964523 Test: 0.16123563218390805 Train loss: 2.106391172435397 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 7 training...
Evaluating...
Train: 0.761687979539642 Validation: 0.5892239467849224 Test: 0.6423275862068966 Train loss: 1.6396074631783362 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 8 training...
Evaluating...
Train: 0.7520588235294118 Validation: 0.589490022172949 Test: 0.6129597701149425 Train loss: 1.27194015950623 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 9 training...
Evaluating...
Train: 0.8008567774936062 Validation: 0.6034146341463414 Test: 0.6392241379310345 Train loss: 1.01774960233176 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 10 training...
Evaluating...
Train: 0.8310613810741688 Validation: 0.6294235033259423 Test: 0.6723275862068966 Train loss: 0.8887826344044041 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 11 training...
Evaluating...
Train: 0.833849104859335 Validation: 0.6124390243902439 Test: 0.6484770114942529 Train loss: 0.7772597538920062 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 12 training...
Evaluating...
Train: 0.8594629156010231 Validation: 0.6387583148558759 Test: 0.6795114942528736 Train loss: 0.671023220668277 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 13 training...
Evaluating...
Train: 0.8728516624040921 Validation: 0.6382261640798226 Test: 0.6886494252873563 Train loss: 0.6015672648993188 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 14 training...
Evaluating...
Train: 0.899923273657289 Validation: 0.6681374722838137 Test: 0.7250862068965517 Train loss: 0.5399662279927838 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 15 training...
Evaluating...
Train: 0.899616368286445 Validation: 0.6469623059866962 Test: 0.6979310344827586 Train loss: 0.49402674255853 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 16 training...
Evaluating...
Train: 0.8971994884910486 Validation: 0.656319290465632 Test: 0.714683908045977 Train loss: 0.4556193112985592 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 17 training...
Evaluating...
Train: 0.9132736572890026 Validation: 0.6701773835920177 Test: 0.7235344827586206 Train loss: 0.4134431600924307 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 18 training...
Evaluating...
Train: 0.9162404092071611 Validation: 0.6738580931263858 Test: 0.7177298850574713 Train loss: 0.41145890410959035 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 19 training...
Evaluating...
Train: 0.9142710997442455 Validation: 0.6727716186252771 Test: 0.7216666666666667 Train loss: 0.38866398282007675 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 20 training...
Evaluating...
Train: 0.934616368286445 Validation: 0.678470066518847 Test: 0.7270689655172414 Train loss: 0.3548556927183061 lr: 0.0005
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 21 training...
Evaluating...
Train: 0.9371483375959079 Validation: 0.6784257206208426 Test: 0.7280172413793103 Train loss: 0.2845035714147622 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 22 training...
Evaluating...
Train: 0.946764705882353 Validation: 0.684079822616408 Test: 0.737183908045977 Train loss: 0.2706801468375369 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 23 training...
Evaluating...
Train: 0.9528388746803069 Validation: 0.6888470066518847 Test: 0.743132183908046 Train loss: 0.2533051081995576 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 24 training...
Evaluating...
Train: 0.9546675191815857 Validation: 0.683569844789357 Test: 0.7456896551724138 Train loss: 0.24527160908703718 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 25 training...
Evaluating...
Train: 0.9522506393861893 Validation: 0.6764079822616408 Test: 0.7348275862068966 Train loss: 0.2348254039920196 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 26 training...
Evaluating...
Train: 0.9528005115089514 Validation: 0.6903769401330377 Test: 0.7435919540229885 Train loss: 0.23426202243215324 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 27 training...
Evaluating...
Train: 0.9565728900255754 Validation: 0.6923059866962306 Test: 0.7364367816091955 Train loss: 0.23163120624565087 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 28 training...
Evaluating...
Train: 0.9567519181585677 Validation: 0.6828159645232816 Test: 0.7239942528735632 Train loss: 0.2141618774868487 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 29 training...
Evaluating...
Train: 0.9530434782608695 Validation: 0.6833259423503326 Test: 0.7350574712643678 Train loss: 0.2122252416871671 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_1.tar... Model saved.
Epoch 30 training...
Evaluating...
Train: 0.960843989769821 Validation: 0.691330376940133 Test: 0.7358333333333333 Train loss: 0.20542419555995411 lr: 0.0004
Saving model as 7e9542b_1603430026_ogbg-ppa_0.tar... Model saved.
Epoch 31 training...
Traceback (most recent call last):
  File "./main.py", line 230, in <module>
    main()
  File "./main.py", line 172, in main
    train_loss = train(model, device, train_loader, optimizer, multicls_criterion)
  File "./main.py", line 32, in train
    loss.backward()
  File "/opt/conda/lib/python3.6/site-packages/torch/tensor.py", line 198, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph)
  File "/opt/conda/lib/python3.6/site-packages/torch/autograd/__init__.py", line 100, in backward
    allow_unreachable=True)  # allow_unreachable flag
RuntimeError: CUDA out of memory. Tried to allocate 842.00 MiB (GPU 0; 11.78 GiB total capacity; 8.16 GiB already allocated; 645.69 MiB free; 10.06 GiB reserved in total by PyTorch) (malloc at /pytorch/c10/cuda/CUDACachingAllocator.cpp:289)
frame #0: c10::Error::Error(c10::SourceLocation, std::string const&) + 0x46 (0x7fe6f78e4536 in /opt/conda/lib/python3.6/site-packages/torch/lib/libc10.so)
frame #1: <unknown function> + 0x1cf1e (0x7fe6f7b2df1e in /opt/conda/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #2: <unknown function> + 0x1df9e (0x7fe6f7b2ef9e in /opt/conda/lib/python3.6/site-packages/torch/lib/libc10_cuda.so)
frame #3: THCStorage_resize + 0x96 (0x7fe6f8da33d6 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #4: at::native::(anonymous namespace)::resize_cuda_(at::Tensor&, c10::ArrayRef<long>, c10::optional<c10::MemoryFormat>) + 0x9aa (0x7fe6fa5c6e4a in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #5: <unknown function> + 0x2887de3 (0x7fe6fa5c7de3 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #6: <unknown function> + 0xf0ffe2 (0x7fe6f8c4ffe2 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #7: <unknown function> + 0x1041be6 (0x7fe6f8d81be6 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #8: <unknown function> + 0xf65018 (0x7fe6f8ca5018 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cuda.so)
frame #9: <unknown function> + 0x10c2780 (0x7fe735615780 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #10: <unknown function> + 0x2c9b47e (0x7fe7371ee47e in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #11: <unknown function> + 0x10c2780 (0x7fe735615780 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #12: at::Tensor c10::Dispatcher::callUnboxed<at::Tensor, at::Tensor const&, at::Tensor const&>(c10::OperatorHandle const&, at::Tensor const&, at::Tensor const&) const + 0xb3 (0x7fe743956da3 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #13: <unknown function> + 0x28ac327 (0x7fe736dff327 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #14: torch::autograd::generated::AddmmBackward::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&) + 0x134 (0x7fe736e39ff4 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #15: <unknown function> + 0x2d89705 (0x7fe7372dc705 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #16: torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&) + 0x16f3 (0x7fe7372d9a03 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #17: torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&, bool) + 0x3d2 (0x7fe7372da7e2 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #18: torch::autograd::Engine::thread_init(int) + 0x39 (0x7fe7372d2e59 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_cpu.so)
frame #19: torch::autograd::python::PythonEngine::thread_init(int) + 0x38 (0x7fe743c1a5f8 in /opt/conda/lib/python3.6/site-packages/torch/lib/libtorch_python.so)
frame #20: <unknown function> + 0xbd66f (0x7fe744ac966f in /usr/lib/x86_64-linux-gnu/libstdc++.so.6)
frame #21: <unknown function> + 0x76db (0x7fe7469ef6db in /lib/x86_64-linux-gnu/libpthread.so.0)
frame #22: clone + 0x3f (0x7fe74671888f in /lib/x86_64-linux-gnu/libc.so.6)

