{'dataset_name': 'ogbg-code', 'seed': 777, 'num_workers': 0, 'feature': 'full', 'max_seq_len': 5, 'num_vocab': 5000, 'hyperparams': {'batch_size': 64, 'epochs': 46, 'learning_rate': 0.0001, 'step_size': 5, 'decay_rate': 0.6}, 'architecture': {'layers': 4, 'hidden': 512, 'pooling': 'mean', 'JK': 'cat', 'nonlinear_conv': 'CA', 'dropout': 0.5, 'variants': {'BN': 'Y', 'fea_activation': 'ReLU'}}, 'commit_id': 'b1e82dd32d1089453a2bcac386c86153ad3dd67b', 'time_stamp': '1601344701', 'directory': '../../../nlg_results/dc2-Ymq2/ogbg/board/'}
Target seqence less or equal to 5 is 0.9874166466036873%.
Coverage of top 5000 vocabulary:
0.9025832389087423
Epoch 1 training...
Average training loss: 3.069155512678857
Evaluating...
Train: 0.19420412790425037 Validation: 0.17752240819909665 Test: 0.18762639411901302 Train loss: 3.069155512678857
Epoch 2 training...
Average training loss: 2.485110284655702
Evaluating...
Train: 0.2629210521720424 Validation: 0.23110957305636712 Test: 0.24596030602044816 Train loss: 2.485110284655702
Epoch 3 training...
Average training loss: 2.268077531421886
Evaluating...
Train: 0.29742904410674265 Validation: 0.25312650418054283 Test: 0.271201854915633 Train loss: 2.268077531421886
Epoch 4 training...
Average training loss: 2.1159302477556117
Evaluating...
Train: 0.3246416214632838 Validation: 0.2680183524334815 Test: 0.28966334831561735 Train loss: 2.1159302477556117
Epoch 5 training...
Average training loss: 1.9894481755237954
Evaluating...
Train: 0.35078221043195235 Validation: 0.28302085272107624 Test: 0.30282722233925075 Train loss: 1.9894481755237954
Epoch 6 training...
Average training loss: 1.8349491069644106
Evaluating...
Train: 0.37462433133194506 Validation: 0.2888131782706003 Test: 0.3090478780883374 Train loss: 1.8349491069644106
Epoch 7 training...
Average training loss: 1.7531909800697776
Evaluating...
Train: 0.39307179249473256 Validation: 0.2948847126149138 Test: 0.3143014210947508 Train loss: 1.7531909800697776
Epoch 8 training...
Average training loss: 1.6812481139126947
Evaluating...
Train: 0.4022357258502921 Validation: 0.2925225811670129 Test: 0.3126781036431118 Train loss: 1.6812481139126947
Epoch 9 training...
Average training loss: 1.6148001240374996
Evaluating...
Train: 0.42030613210122636 Validation: 0.29453423597921125 Test: 0.3118233744668955 Train loss: 1.6148001240374996
Epoch 10 training...
Average training loss: 1.5506951856052174
Evaluating...
Train: 0.43482541413178155 Validation: 0.29774508652538195 Test: 0.31564753210461244 Train loss: 1.5506951856052174
Epoch 11 training...
Average training loss: 1.4424355306905858
Evaluating...
Train: 0.4534814833014752 Validation: 0.295827131627193 Test: 0.3171151424158532 Train loss: 1.4424355306905858
Epoch 12 training...
Average training loss: 1.3924946084209517
Evaluating...
Train: 0.4704457492929062 Validation: 0.29895808807146845 Test: 0.3188099163153838 Train loss: 1.3924946084209517
Epoch 13 training...
Average training loss: 1.3489349236488342
Evaluating...
Train: 0.47623364282155795 Validation: 0.2930651249185675 Test: 0.31396104553567644 Train loss: 1.3489349236488342
Epoch 14 training...
Average training loss: 1.3077988507607403
Evaluating...
Train: 0.4909709030882324 Validation: 0.2973753778811411 Test: 0.3167388200261355 Train loss: 1.3077988507607403
Epoch 15 training...
Average training loss: 1.2677364565344418
Evaluating...
Train: 0.5011468627709531 Validation: 0.29517797702922827 Test: 0.31651039739476045 Train loss: 1.2677364565344418
Epoch 16 training...
Average training loss: 1.190588426739562
Evaluating...
Train: 0.5183624654784416 Validation: 0.29467462458214966 Test: 0.314703239928773 Train loss: 1.190588426739562
Epoch 17 training...
Average training loss: 1.1566831209986819
Evaluating...
Train: 0.5279302136611912 Validation: 0.2940715831674327 Test: 0.3145521942063768 Train loss: 1.1566831209986819
Epoch 18 training...
Average training loss: 1.1311268886023877
Evaluating...
Train: 0.5375758863457984 Validation: 0.29365947999203906 Test: 0.31432890636690525 Train loss: 1.1311268886023877
Epoch 19 training...
Average training loss: 1.1047267595272439
Evaluating...
Train: 0.5485547956050721 Validation: 0.2940285340776203 Test: 0.3138473930641782 Train loss: 1.1047267595272439
Epoch 20 training...
Average training loss: 1.080719491294786
Evaluating...
Train: 0.5503137981871364 Validation: 0.2921890187065276 Test: 0.3133306955887601 Train loss: 1.080719491294786
Epoch 21 training...
Average training loss: 1.0295749285641838
Evaluating...
Train: 0.5665561539261309 Validation: 0.2921531476271363 Test: 0.31445673375689775 Train loss: 1.0295749285641838
Epoch 22 training...
Average training loss: 1.0084749374109157
Evaluating...
Train: 0.570504195289965 Validation: 0.29062912952994907 Test: 0.312882666914925 Train loss: 1.0084749374109157
Epoch 23 training...
Average training loss: 0.9914238396812888
Evaluating...
Train: 0.5760506488327215 Validation: 0.2909564721021091 Test: 0.312616742551133 Train loss: 0.9914238396812888
Epoch 24 training...
Average training loss: 0.9759956855867423
Evaluating...
Train: 0.5814922314574993 Validation: 0.2896159612642936 Test: 0.3096398255774964 Train loss: 0.9759956855867423
Epoch 25 training...
Average training loss: 0.9605147819519043
Evaluating...
Train: 0.5858639320570166 Validation: 0.2895294551713012 Test: 0.3103525853184136 Train loss: 0.9605147819519043
Epoch 26 training...
Average training loss: 0.9281461415945315
Evaluating...
Train: 0.5922385535474816 Validation: 0.2893757730195474 Test: 0.31009996802096307 Train loss: 0.9281461415945315
Epoch 27 training...
Average training loss: 0.9155104987761553
Evaluating...
Train: 0.5975185196965886 Validation: 0.29023972720777735 Test: 0.3112742804650951 Train loss: 0.9155104987761553
Epoch 28 training...
Average training loss: 0.9059857051325779
Evaluating...
Train: 0.6033516292128623 Validation: 0.2898863888542637 Test: 0.3095011533229138 Train loss: 0.9059857051325779
Epoch 29 training...
Average training loss: 0.8962607547722611
Evaluating...
Train: 0.6073000886000826 Validation: 0.2886582217848379 Test: 0.30942633723524926 Train loss: 0.8962607547722611
Epoch 30 training...
Average training loss: 0.886811951412874
Evaluating...
Train: 0.6094864965367637 Validation: 0.28871906411898524 Test: 0.30827545679924034 Train loss: 0.886811951412874
Epoch 31 training...
Average training loss: 0.8664703237309176
Evaluating...
Train: 0.6129221141746359 Validation: 0.28871047896555196 Test: 0.30956107456927573 Train loss: 0.8664703237309176
Epoch 32 training...
Average training loss: 0.859455059116962
Evaluating...
Train: 0.6190865139534854 Validation: 0.2901602125601775 Test: 0.3102965365335513 Train loss: 0.859455059116962
Epoch 33 training...
Average training loss: 0.853327443524903
Evaluating...
Train: 0.6176917972116581 Validation: 0.28888815211513197 Test: 0.3093152521597027 Train loss: 0.853327443524903
Epoch 34 training...
Average training loss: 0.8477622828016094
Evaluating...
Train: 0.62019792243996 Validation: 0.2886060541164192 Test: 0.30960211016936007 Train loss: 0.8477622828016094
Epoch 35 training...
Average training loss: 0.8415130333666708
Evaluating...
Train: 0.6220972173198619 Validation: 0.28698827918707837 Test: 0.3070683829363436 Train loss: 0.8415130333666708
Epoch 36 training...
Average training loss: 0.8298652063584795
Evaluating...
Train: 0.6280810567536254 Validation: 0.2871045683071804 Test: 0.3067981916328007 Train loss: 0.8298652063584795
Epoch 37 training...
Average training loss: 0.8258769548406788
Evaluating...
Train: 0.6264066892224888 Validation: 0.28834148909531304 Test: 0.30827050280986856 Train loss: 0.8258769548406788
Epoch 38 training...
Average training loss: 0.821731259729348
Evaluating...
Train: 0.6308578078288057 Validation: 0.28991895868128503 Test: 0.3102132983352229 Train loss: 0.821731259729348
Epoch 39 training...
Average training loss: 0.8178489327337227
Evaluating...
Train: 0.6290033898130238 Validation: 0.2881077253036757 Test: 0.30730216060997906 Train loss: 0.8178489327337227
Epoch 40 training...
Average training loss: 0.8150952141051199
Evaluating...
Train: 0.6316148984424688 Validation: 0.28685145331943773 Test: 0.30769919968252385 Train loss: 0.8150952141051199
Epoch 41 training...
Average training loss: 0.807297562641256
Evaluating...
Train: 0.6358366204306768 Validation: 0.28984820407663026 Test: 0.31025603676642494 Train loss: 0.807297562641256
Epoch 42 training...
Average training loss: 0.8050399193529989
Evaluating...
Train: 0.637493376418451 Validation: 0.2882981607660575 Test: 0.3084007891142938 Train loss: 0.8050399193529989
Epoch 43 training...
Average training loss: 0.8030113389211543
Evaluating...
Train: 0.6346815564157087 Validation: 0.2879151269518101 Test: 0.3079746013863018 Train loss: 0.8030113389211543
Epoch 44 training...
Average training loss: 0.8001218476155225
Evaluating...
Train: 0.6369748506153528 Validation: 0.28824629885023456 Test: 0.309036240979926 Train loss: 0.8001218476155225
Epoch 45 training...
Average training loss: 0.7983103581409828
Evaluating...
Train: 0.6371869438032517 Validation: 0.28895497717867 Test: 0.3098874165645625 Train loss: 0.7983103581409828
Epoch 46 training...
Average training loss: 0.7936992062914605
Evaluating...
Train: 0.6385582268376536 Validation: 0.2888549287024108 Test: 0.309354229898243 Train loss: 0.7936992062914605
F1
Finished training!
Best validation score: 0.29895808807146845
Test score: 0.3188099163153838
Finished test: 0.3188099163153838, Validation: 0.29895808807146845, Train: 0.4704457492929062, epoch: 11, best train: 0.6385582268376536, best loss: 0.7936992062914605
